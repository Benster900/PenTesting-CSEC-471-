"""
Author: Ben Bornholm
Date: 2-1-16
Description: A web scraper for pen testing
	-f: take a file with a bunch of links
	-l: take a web link in
"""
from urllib2 import urlopen
from bs4 import BeautifulSoup
import time
import sys
import threading

def connection(link,sleepTime):
	#enter web page to get contents
	htmlPage = urlopen(link)
	
	#Create beautiful soup object
	bsObj = BeautifulSoup(htmlPage.read())
	
	#Print object
	print (bsObj)
	
	#Make thread sleep
	time.sleep(sleepTime)

def main():
	print len(sys.argv)
	if len(sys.argv) < 2:
		print "Usage: python webScraper.py -f <file with a list of links> -t <seconds of sleep>"
		print "Usage: python webScraper.py -l <web link>"
		print "Usage: python webScraper.py -l <web link> -p <types of permutations(alphabet,letters,symbols> -s <size of permutation> -t <seconds of sleep> "

	#for file
	if '-f' in sys.argv:
		f = open(sys.argv[2], 'r')
		for line in f:
			threads = []
			for i in range(20):
				t = threading.Thread(target=connection, args=(line,int(sys.argv[4])))
				threads.append(t)
				t.start()
	#for permutations
	if '-l' and '-p' in sys.argv:
		alphabetLower = ['a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z']
		alphabetUpper = ['A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z']
		numbers = ['0','1','2','3','4','5','6','7','8','9']
		symbols = ['!','@','#','$','%','^','&','*','(',')','-','=','+','~','`',"'",'"','?','<','>','{','}','[',']','_','|',':',';']
	
	#generate list of permuatations		
	lst = []

	#go through each permutation
	for x in lst:
		threads = []
		for i in range(20):
			for i in range(20):
				webLink = link +'/'+ i
                                t = threading.Thread(target=connection, args=(webLink,int(sys.argv[4])))
                                threads.append(t)
                                t.start()

	#for web link		
	if '-l' in sys.argv:	
		webLink = sys.argv[2]
		connection(webLink,0)
main()
